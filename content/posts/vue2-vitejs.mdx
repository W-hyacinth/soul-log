---
title: "Vue2ì— Vite.js ì ìš©í•˜ê¸°"
description: "Vue2 í”„ë¡œì íŠ¸ì— Webpack ëŒ€ì‹  Vite.jsë¥¼ ë²ˆë“¤ëŸ¬ë¡œ ì „í™˜í•˜ëŠ” ê³¼ì •ì—ì„œ ê²ªì€ ì´ìŠˆì™€ í•´ê²° ë°©ë²•ì„ ì •ë¦¬í•©ë‹ˆë‹¤."
date: 2024-01-15
tags: ["Vue.js", "Vite", "Frontend"]
cover: null
---

<Callout emoji="ğŸ’¡">
ì¼ì •ê³¼ ì¸ë ¥ ë¬¸ì œë¡œ ì°¨ì„ ì±…ìœ¼ë¡œ ë‹¤ì‹œ Vue2ë¡œ ëŒì•„ì˜¤ê²Œ ë˜ì—ˆì§€ë§Œ, Vue3 Viteì˜ ë§›ì„ ë³´ê³  ë‚˜ë‹ˆ `npm run dev` ì‹¤í–‰ ì‹œ ëŠë¦° ì†ë„ë¥¼ ê²¬ë”œ ìˆ˜ê°€ ì—†ì—ˆìŠµë‹ˆë‹¤. ë²ˆë“¤ëŸ¬ë§Œí¼ì€ Viteë¡œ ë°”ê¾¸ê¸°ë¡œ í–ˆìŠµë‹ˆë‹¤.
</Callout>

## ì ìš© ê³¼ì •ì—ì„œ í™•ì¸ëœ ì‚¬í•­

- ViteëŠ” ê¸°ë³¸ì ìœ¼ë¡œ Vue3ì— ìµœì í™”ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ì´ˆê¸° ì„¤ì •ì—ì„œ Vue ë²„ì „ì´ 3ìœ¼ë¡œ ì„¤ì •ë©ë‹ˆë‹¤.
  - Vite ë²„ì „ì„ ë‚®ì¶”ê³  npmì—ì„œ Vue2ë¡œ ë‹¤ìš´ê·¸ë ˆì´ë“œí•´ì„œ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.

  ```bash
  npm create vite@3
  npm uninstall @vitejs/plugin-vue
  npm i vue@2
  ```

- Vue2ë¡œ ë³€ê²½ ì‹œ `npm i vue-router vuex`ë¡œ ë²„ì „ì„ ì¶”ê°€í•˜ë ¤ê³  í•˜ë©´ ì„¤ì¹˜ê°€ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
  - ì„¤ì¹˜ê°€ ì•ˆ ë˜ëŠ” ì´ìœ ëŠ” vue-routerì™€ vuexê°€ Vueì˜ ë²„ì „ì— ë”°ë¼ ì˜ì¡´ì„± ì´ìŠˆê°€ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
  - vue-routerì™€ vuexë¥¼ ì„¤ì¹˜í•  ë•ŒëŠ” ë²„ì „ì„ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤.

  ```bash
  npm i vue-router@3 vuex@3 portal-vue@2 @vitejs/plugin-vue2
  ```

  - ê·¸ ì™¸ ê¸°íƒ€ í”ŒëŸ¬ê·¸ì¸ë“¤ ì¤‘ Vue3ë¥¼ ì§€ì›í•˜ëŠ” ê²ƒë“¤ì€ ë²„ì „ ë¯¸ì„ ì–¸ ì‹œ Vue3 ê¸°ì¤€ìœ¼ë¡œ ì„¤ì¹˜ë¥¼ ì‹œë„í•˜ë‹¤ê°€ ì‹¤íŒ¨í•˜ê¸° ë•Œë¬¸ì— ë²„ì „ ì„ ì–¸ì„ í•´ì£¼ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.
  - Vue2ì—ì„œ ì§€ì›ëœ íŒ¨í‚¤ì§€ ì¤‘ Viteì—ì„œ ì‚¬ìš© ë¶ˆê°€í•œ ê²ƒë“¤ì´ ì¼ë¶€ ìˆë‹¤ê³  ì•Œë ¤ì ¸ ìˆìŠµë‹ˆë‹¤.
    - ë‹¤í–‰íˆ í˜„ì¬ ì„œë¹„ìŠ¤ ê¸°ì¤€ì—ì„œëŠ” í™•ì¸ë˜ì§€ ì•Šì•˜ìœ¼ë©°, ë¯¸ì§€ì› ì‹œ ëŒ€ì²´ í”ŒëŸ¬ê·¸ì¸ì„ ì°¾ìœ¼ë©´ ë©ë‹ˆë‹¤.
    - Vue3ì—ì„œë„ ì§€ì›ë˜ëŠ” íŒ¨í‚¤ì§€ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ Vite ì§€ì›ì´ê¸° ë•Œë¬¸ì— Vue2ì—ì„œë„ ì§€ì›ë˜ë„ë¡ ì„¤ê³„ëœ ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤. (ì˜ˆ: element-ui, portal-vue)

- `require` ì‚¬ìš©ì´ ë¶ˆê°€í•©ë‹ˆë‹¤.
  - ê¸°ì¡´ storeì—ì„œ íŒŒì¼ ìƒì„± ì‹œ ìë™ ì²˜ë¦¬í•˜ëŠ” ì½”ë“œì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤.
  - í˜„ì¬ëŠ” ê°œë³„ íŒŒì¼ì„ `import`í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì„ì‹œ ì²˜ë¦¬í•˜ê³  ìˆìŠµë‹ˆë‹¤.
    - ì´ ì´ìŠˆë¡œ Viteë¥¼ í¬ê¸°í•˜ê¸°ì—” ì•„ì‰½ê¸° ë•Œë¬¸ì— ë‚˜ì¤‘ì— storeì— íŒŒì¼ ìƒì„± ì‹œ ìë™ìœ¼ë¡œ ëª¨ë“ˆì´ ë¶™ë„ë¡ í•˜ëŠ” ë°©ë²•ì„ ê³ ë¯¼í•´ë³¼ ì˜ˆì •ì…ë‹ˆë‹¤.

- `this._vm.xx` í˜•íƒœë¡œ ì‘ì„±ëœ ë¡œì§ì„ í™”ì‚´í‘œ í•¨ìˆ˜ë¡œ ë³€ê²½í•˜ë©´ `this` ê°ì²´ê°€ Vue ì¸ìŠ¤í„´ìŠ¤ê°€ ì•„ë‹Œ `undefined`ë¡œ ì¸ì‹ë˜ëŠ” ìƒí™©ì´ ë°œìƒí•©ë‹ˆë‹¤.
  - storeì—ì„œëŠ” ë˜ë„ë¡ `function(){}` í˜•íƒœë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.

- env í™˜ê²½ ë³€ìˆ˜ì— ì§€ì •í•œ ë³€ìˆ˜ëª…ì˜ prefixëŠ” `VITE`ë¡œ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤.
  - ê·¸ë˜ì•¼ `import.meta.env`ë¡œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - prefix ê°’ì´ ë§ˆìŒì— ë“¤ì§€ ì•ŠëŠ”ë‹¤ë©´ `vite.config.js` ì„¤ì •ì—ì„œ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ê¸°ì¡´ `process.env`ëŠ” `import.meta.env`ë¡œ êµì²´í•´ì„œ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.

- `vite.config.js`ì—ì„œ env í™˜ê²½ë³€ìˆ˜ë¥¼ í™œìš©í•´ ê¸€ë¡œë²Œ ë³€ìˆ˜ë¥¼ ì„ ì–¸í•˜ë ¤ê³  í•˜ë©´ ì•„ë˜ ì—ëŸ¬ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - `GET https://.../node_modules/vite/dist/client/env.mjs net::ERR_ABORTED 500 (Internal Server Error)`
  - [ê´€ë ¨ ì´ìŠˆ](https://github.com/vitejs/vite/issues/9167)ë¥¼ ì°¸ì¡°í•´ `JSON.stringify('valueê°’')` í˜•íƒœë¡œ í• ë‹¹í•´ì•¼ ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

- `ì¤‘ìš”` env ë‚´ ì„¤ì • ê°’ì„ í¸í•˜ê²Œ ì‚¬ìš©í•˜ë ¤ê³  ë¬´ì‘ì • `define`ì— ê¸€ë¡œë²Œ ë³€ìˆ˜ë¡œ ì§€ì •í•˜ì§€ ì•Šë„ë¡ ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤.
  - ê¸€ë¡œë²Œ ì„ ì–¸ ì‹œ `window` ê°ì²´ì— ë…¸ì¶œë˜ì–´ ì¤‘ìš” ì •ë³´ê°€ ì™¸ë¶€ì—ì„œ í™•ì¸ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- í˜„ì¬ ì„œë¹„ìŠ¤ì˜ dev ì„œë²„ì— ì˜¬ë¼ê°€ì•¼ í•˜ëŠ” í™˜ê²½ ë³€ìˆ˜ëŠ” `.env.devserver`ì—ì„œ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤.
  - `.env.development`ì— ì§€ì •í•´ì•¼ í•œë‹¤ê³  ì°©ê°í•˜ê¸° ì‰¬ìš°ë¯€ë¡œ ì£¼ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤.

- ì „ì—­ì—ì„œ ì„ ì–¸í•œ ë³€ìˆ˜ë¥¼ ì •ìƒì ìœ¼ë¡œ ì¸ì‹í•˜ì§€ ëª»í•˜ëŠ” ê²½ìš°ê°€ ê°„í˜¹ ìˆìŠµë‹ˆë‹¤.

---

## ë¹Œë“œ ë° ì‹¤ì œ ì„œë¹„ìŠ¤ ì ìš© ê³¼ì •ì—ì„œ í™•ì¸ëœ ì´ìŠˆë“¤

### `define`ì— `global`ë¡œ ì„ ì–¸ ì‹œ ë¹Œë“œ ì—ëŸ¬ ë°œìƒ

íŒ¨í‚¤ì§€ ì—ëŸ¬ë¥¼ í•´ì†Œí•˜ê³ ì `define`ì— `global`ë¡œ ì„ ì–¸í–ˆì„ ê²½ìš° ë¹Œë“œ ë‹¨ê³„ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤.

![define global ì„ ì–¸ ì‹œ ë¹Œë“œ ì—ëŸ¬ ìŠ¤í¬ë¦°ìƒ·](/images/vue2-vitejs/build-error-global.png)

ì„ ì–¸ ë°©ì‹ì„ `global`ì´ ì•„ë‹Œ `window.global`ë¡œ ë³€ê²½í•´ì•¼ í•´ê²°ë©ë‹ˆë‹¤.

- [ê´€ë ¨ ì´ìŠˆ ì°¸ê³ ](https://github.com/nuxt/nuxt/issues/13941)

### GitHub Actions ë¹Œë“œ ì‹¤íŒ¨

**1. vuex store ë¹Œë“œ ì‹¤íŒ¨**

```
ENOENT: no such file or directory, open '.../src/store/modules/file'
```

![GitHub Actions vuex store ë¹Œë“œ ì‹¤íŒ¨ ìŠ¤í¬ë¦°ìƒ·](/images/vue2-vitejs/github-actions-build-fail.png)

- **ì›ì¸**: `File.js`ì™€ `User.js`ê°€ `modules` í•˜ìœ„ í´ë” ë””ë ‰í† ë¦¬ì— ìœ„ì¹˜í•˜ì§€ ì•Šì•„ì„œ ë°œìƒí•œ ì´ìŠˆì…ë‹ˆë‹¤.
- **í•´ê²°**: `File.js`ì™€ `User.js`ë¥¼ `common` í´ë” ìƒì„± í›„ í•´ë‹¹ ë””ë ‰í† ë¦¬ë¡œ ì´ë™í•˜ì—¬ í•´ê²°í–ˆìŠµë‹ˆë‹¤.

**2. ì¥ì‹œê°„ í˜ì´ì§€ë¥¼ ì¼œë†“ìœ¼ë©´ ë™ì  import ì—ëŸ¬ ë°œìƒ**

```
TypeError: Failed to fetch dynamically imported module
```

ì´ í˜„ìƒì€ Webpackì—ì„œë„ ì¢…ì¢… ë°œìƒí•˜ëŠ” ì´ìŠˆì´ë‚˜, Vite ì ìš© ì´í›„ ë¹ˆë„ê°€ ì¦ì•„ì§„ ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.

- [ê´€ë ¨ ì´ìŠˆ](https://github.com/vitejs/vite/issues/11804)

ì‹œë„í•œ í•´ê²° ë°©ë²•ë“¤:

1. `router.onError`ë¡œ í•´ë‹¹ íƒ€ì… ì—ëŸ¬ ë°œìƒ ì‹œ ìƒˆë¡œê³ ì¹¨ ì²˜ë¦¬ë¥¼ ì¶”ê°€í–ˆìœ¼ë‚˜, `window.location = to.fullPath`ì—ì„œ `fullPath` ê°’ì´ ì—†ë‹¤ëŠ” ì—ëŸ¬ê°€ ë°˜í™˜ë˜ì–´ í˜„ì¬ëŠ” ì´ìŠˆê°€ ì¬í˜„ë˜ì§€ ì•ŠëŠ” ìƒíƒœì…ë‹ˆë‹¤.
2. Vite ê³µì‹ ë¬¸ì„œì˜ [ë¡œë“œ ì—ëŸ¬ ì²˜ë¦¬ ë°©ì•ˆ](https://ko.vitejs.dev/guide/build.html#load-error-handling) ì ìš© â€” ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.
3. router ë‚´ ì»´í¬ë„ŒíŠ¸ ê²½ë¡œ ì§€ì • ë°©ì‹ ë³€ê²½ì„ ì‹œë„í–ˆìŠµë‹ˆë‹¤.

**3. MIME type ì—ëŸ¬**

```
Failed to load module script: Expected a JavaScript module script but the server responded with a MIME type of "text/html".
```

ì£¼ë¡œ Storybook ì„¸íŒ… ì‹œ ë°œìƒí•˜ëŠ” ì´ìŠˆë¡œ ì•Œë ¤ì ¸ ìˆìœ¼ë‚˜, í˜„ì¬ í™˜ê²½ì—ëŠ” ê´€ë ¨ ì„¸íŒ…ì´ ì—†ì–´ ì›ì¸ íŒŒì•… ì¤‘ì…ë‹ˆë‹¤.

**4. `vertx` ëª¨ë“ˆ not found**

```
Failed to resolve import "vertx" from "node_modules/..."
```

- `html2pdf` íŒ¨í‚¤ì§€ ì„¤ì¹˜ í›„ ì ìš© ê³¼ì •ì—ì„œ ë°œìƒí•œ ì—ëŸ¬ì…ë‹ˆë‹¤.
- `viteCommonjs` í”ŒëŸ¬ê·¸ì¸ì— `skipPreBuild: true` ì˜µì…˜ ì¶”ê°€ í›„ í•´ê²°ë˜ì—ˆìŠµë‹ˆë‹¤.
- [ê´€ë ¨ ì´ìŠˆ ì°¸ê³ ](https://github.com/auth0/auth0.js/issues/1250#issuecomment-1373461500)

---

## ì‹¤ì œ ê°œì„ ëœ ì 

### ë¹Œë“œ ì†ë„ í–¥ìƒ

2ì°¨ ìŠ¤í”„ë¦°íŠ¸ ê¸°ì¤€ìœ¼ë¡œ ì ì°¨ ë¹Œë“œí•´ì•¼ í•  íŒŒì¼ ë° ì„¤ì •ì´ ëŠ˜ì–´ë‚˜ê³  ìˆìŒì—ë„ 2ë¶„ì´ ë„˜ì–´ê°€ëŠ” ê²½ìš°ê°€ ë§¤ìš° ë“œë­…ë‹ˆë‹¤. ì´ˆë°˜ ì„¤ì •ê³¼ í¬ê²Œ ì°¨ì´ê°€ ì—†ëŠ” ìˆ˜ì¤€ì„ ìœ ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤.

### ê¸€ë¡œë²Œ ë³€ìˆ˜ë¡œ API ê²½ë¡œë¥¼ ê¹”ë”í•˜ê²Œ ì„ ì–¸ ê°€ëŠ¥

**Vite ì ìš© ì „ (Webpack ë°©ì‹)**

```javascript
// src/mixin/https.js
Vue.mixin({
  computed: {
    SPARK_ONE_CREW_API_URL() {
      return process.env.VUE_APP_SPARK_ONE_CREW_API_URL
    },
    // ... ì´í•˜ ìƒëµ
  },
})

// src/store/index.js
import '@/mixin/http'

// src/store/modules/User.js
export default {
  namespaces: true,
  actions: {
    async login({ dispatch }, payload) {
      const response = await this._vm.post(
        `${this._vm.SPARK_ONE_CREW_API_URL}login`,
        payload,
      )
      return response
    },
    // ... ì´í•˜ ìƒëµ
  }
}
```

**Vite ì ìš© í›„**

```javascript
// vite.config.js
import { defineConfig, loadEnv } from 'vite'

export default defineConfig(({ mode }) => {
  const env = { ...process.env, ...loadEnv(mode, process.cwd()) }
  return {
    define: {
      VITE_DEFAULT_API_URL: JSON.stringify(env.VITE_APP_DEFAULT_API_URL),
    },
    // ... ì´í•˜ ìƒëµ
  }
})

// src/store/modules/User.js
export default {
  namespaces: true,
  actions: {
    async login({ dispatch }, payload) {
      const response = await this._vm.post(
        `${VITE_DEFAULT_API_URL}login`,
        payload,
      )
      return response
    },
    // ... ì´í•˜ ìƒëµ
  }
}
```

mixinì„ ê±°ì¹˜ì§€ ì•Šê³  ê¸€ë¡œë²Œ ë³€ìˆ˜ë¥¼ ë°”ë¡œ ì°¸ì¡°í•  ìˆ˜ ìˆì–´ ì½”ë“œê°€ í›¨ì”¬ ê°„ê²°í•´ì¡ŒìŠµë‹ˆë‹¤.

---

## ì°¸ê³ ìë£Œ

- [Vite ê³µì‹ ë¬¸ì„œ â€” ì„¤ì •ì—ì„œ í™˜ê²½ ë³€ìˆ˜ ì‚¬ìš©í•˜ê¸°](https://ko.vitejs.dev/config/#using-environment-variables-in-config)
- [vite/dist/client/env.mjs request failed with status code 500 Â· vitejs/vite #9167](https://github.com/vitejs/vite/issues/9167)
